==================
APIs
==================

Overview
------------------

Image Processing includes 3 steps, which are uploading, processing and downloading (or showing). 

Uploading
------------------

upload image to Tencent COS.

Authorization
^^^^^^^^^^^^^^^^^^^^^

Send a GET query for getting a temp secret key to your authorization server. 

+---------------+------------------------------------+
| **Parameter** | **Value**                          |
+---------------+------------------------------------+
| method        | "POST",which is the upload method. |
+---------------+------------------------------------+
| pathname      | "/", which is the path in COS.     |
+---------------+------------------------------------+
| key           | File name                          |
+---------------+------------------------------------+

File uploading
^^^^^^^^^^^^^^^^^^^^^

Using Tencent COS JavaScript SDK to send a POST query for uploading file to Tencent COS server directly. The file size is limited to 20M.

+--------------------------+--------------------------------------------------------------------------+
| **Parameter**            | **Value**                                                                |
+--------------------------+--------------------------------------------------------------------------+
| Authoriza                | Signature generated by previous request.                                 |
+--------------------------+--------------------------------------------------------------------------+
| x-cos-security-token     | The sessionToken of the temp secret key.                                 |
+--------------------------+--------------------------------------------------------------------------+

Processing
------------------

Fetching
^^^^^^^^^^^^^^

Send a POST query for processing uploaded file.

- 'Content-Type': 'application/json'

Field Description

+---------------+----------------------------------------+
| **Parameter** | **Value**                              |
+---------------+----------------------------------------+
| file_name     | File name                              |
+---------------+----------------------------------------+
| op            | operation number (0 - 7)               |
+---------------+----------------------------------------+
| op_par        | operation parameter                    |
+---------------+----------------------------------------+

Rotation
^^^^^^^^^^^^^^^^^^^^^

Field Description

+---------------+------------------------------------+
| **Parameter** | **Value**                          |
+---------------+------------------------------------+
| angle         | The angle to rotate. Counter clock |
+---------------+------------------------------------+

QR code
^^^^^^^^^^^^^^^^^^^^^

Field Description

+---------------+--------------------------------------------+
| **Parameter** | **Value**                                  |
+---------------+--------------------------------------------+
| content       | String store in QR code.                   |
+---------------+--------------------------------------------+
| position      | When fixed = 0, the position of QR         |
|               | Code has 5 choices: 1 for Upper Left,      |
|               | 2 for Upper Right, 3 for Center,           |
|               | 4 for Bottom Left, 5 for Bottom Right      |
|               | (default = 5).                             |
|               | When fixed = 1, the position is defined by |
|               | the pixel point in the original graph      |
|               | (width, height).                           |
+---------------+--------------------------------------------+
| fixed         | 0 for using relative position, 1 for using |
|               | fixed pixel position. (default = 0)        |
+---------------+--------------------------------------------+

Round
^^^^^^^^^^^^^^^^^^^^^

Field Description

+---------------+--------------------------------------------+
| **Parameter** | **Value**                                  |
+---------------+--------------------------------------------+
| radius        | If fixed = 0, radius represent in ratio;   |
|               | If fixed = 1, radius represent in pixel.   |     
+---------------+--------------------------------------------+
| fixed         | 0 for using relative position, 1 for using |
|               | fixed pixel position. (default = 0)        |
+---------------+--------------------------------------------+

Thumbnail
^^^^^^^^^^^^^^^^^^^^^

Field Description

+---------------+------------------------------------+
| **Parameter** | **Value**                          |
+---------------+------------------------------------+
| height        | thumbnail height                   |
+---------------+------------------------------------+
| width         | thumbnail width                    |
+---------------+------------------------------------+

Watermark with text
^^^^^^^^^^^^^^^^^^^^^

Field Description

+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| **Parameter**    | **Value**                                                                                                                                       |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| content          | The water mark text                                                                                                                             |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| font_name        | The path of font style                                                                                                                          |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| size_ratio       | The size of water mark based on input figure                                                                                                    |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| rotate_angle     | The rotate angle for text                                                                                                                       |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| clear_ratio      | How clear the water mark is                                                                                                                     |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| position         | When fixed = 0, the position of QR Code has 5 choices: 1 for Upper Left, 2 for Upper Right, 3 for Center, 4 for Bottom Left, 5 for Bottom Right |
|                  | (default = 5). When fixed = 1, the position is defined by the pixel point in the original graph (width, height).                                |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| fixed            | 0 for using relative position, 1 for using fixed pixel position. (default = 0)                                                                  |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+




 


Watermark with image
^^^^^^^^^^^^^^^^^^^^^

Field Description

+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| **Parameter**   | **Value**                                                                                                                                       |
+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| patch           | The path for water mark image                                                                                                                   |
+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| clear_ratio     | How clear the water mark is                                                                                                                     |
+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| position        | When fixed = 0, the position of QR Code has 5 choices: 1 for Upper Left, 2 for Upper Right, 3 for Center, 4 for Bottom Left, 5 for Bottom Right |
|                 | (default = 5). When fixed = 1, the position is defined by the pixel point in the original graph (width, height).                                |
+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
| fixed           | 0 for using relative position, 1 for using fixed pixel position. (default = 0)                                                                  |
+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------+

Slicing
^^^^^^^^^^^^^^^^^^^^^

Field Description

+---------------+-----------------------------------------------+
| **Parameter** | **Value**                                     |
+---------------+-----------------------------------------------+
| num           | number of slices                              |
+---------------+-----------------------------------------------+
| direction     | 1 for slice vertical, 0 for slice horizontal  | 
+---------------+-----------------------------------------------+

Image Converter
^^^^^^^^^^^^^^^^^^^^^

Field Description

+---------------+------------------------------------+
| **Parameter** | **Value**                          |
+---------------+------------------------------------+
| postfix       | image postfix                      |
+---------------+------------------------------------+


Downloading
------------------

Previous query will return a download file name. Then, the processed image can be downloaded from Tencent COS. 